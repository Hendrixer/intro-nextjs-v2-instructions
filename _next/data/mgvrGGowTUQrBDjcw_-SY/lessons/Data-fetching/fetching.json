{"pageProps":{"post":{"attributes":{"title":"Fetching data"},"html":"<h2 id=\"server-components\">Server components</h2>\n<p>Pages and Layouts might need data before they render. Tapping into APIs, databases, and other sources. Data is cached and streamed to the client automatically. It is recommended to fetch data in server components so the backend can handle this. There are a few reasons for this:</p>\n<ul>\n<li>They have access to backends DBs</li>\n<li>Keeping your app more secure by not exposing API keys and other secrets to the client</li>\n<li>Reduce the load on the main thread in the browser by having both fetching and rendering happening in the same environment on the server</li>\n<li>...and many more reason</li>\n</ul>\n<br>\n\n<h3 id=\"fetch\">Fetch</h3>\n<p>React extends the <code>fetch</code> function to provide automatic request deduplication. This is on a per request basis. Next.js extends fetch by allowing us to customuze how we cache certain data. We can access fetch globally without any imports and it works mostly the same.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&quot;https://api.data.com/...&quot;</span>);\n</code></pre>\n<br>\n\n<p>By default, fetch will cache all results, which is great for static data. But for dynamic data, you can skip the caching.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&quot;https://api.data.com/...&quot;</span>, { <span class=\"hljs-attr\">cache</span>: <span class=\"hljs-string\">&quot;no-store&quot;</span> });\n</code></pre>\n<h3 id=\"async-components\">Async components</h3>\n<p>For server components, we can use <code>async/await</code> on the component level to get our data.</p>\n<pre><code class=\"hljs language-tsx\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">getData</span> = <span class=\"hljs-keyword\">async</span> (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> res = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&quot;https://api.cms.com/....&quot;</span>);\n\n  <span class=\"hljs-keyword\">return</span> res.<span class=\"hljs-title function_\">json</span>();\n};\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">HomePage</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-comment\">// wow! No hooks on server components!</span>\n  <span class=\"hljs-keyword\">const</span> data = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">getData</span>();\n\n  <span class=\"hljs-keyword\">return</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>{data.title}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>;\n}\n</code></pre>\n<h2 id=\"getting-data-without-fetch\">Getting data without fetch</h2>\n<p>Getting data without fetch in server components is supported as well. Like when using a DB, the filesystem, or 3rd party SDKs. You just won&#39;t get all the granular caching and deduping support. You still will get the default caching for route segments. There&#39;s so much more to caching, deduping, and revalidating. I recommend learning more <a href=\"https://beta.nextjs.org/docs/data-fetching/caching\">here</a>.</p>\n<h2 id=\"client-components\">Client components</h2>\n<p>Until we&#39;re able to use the new <code>use()</code> hook from React, client data fetching is mostly the same as always. It&#39;s recommeded to use SWR or ReactQuery.</p>\n","slug":"fetching","title":"Fetching data","section":"Data Fetching","icon":"table","filePath":"/home/runner/work/intro-nextjs-v2-instructions/intro-nextjs-v2-instructions/lessons/05-Data-fetching/A-fetching.md","nextSlug":"/lessons/Data-fetching/static-params","prevSlug":"/lessons/Rendering/client-components"}},"__N_SSG":true}